description: install a specific version of node using nvm

parameters:
  node_version:
    description: The version of Node to use. This can be either a major version ("8"), a major and minor ("8.4"), or a fully qualified version ("8.4.1").
    type: string
    default: '10'
steps:
  - run: 
      name: Install node@<<parameters.node_version>>
      # after `curl`, bashrc contains the script to load nvm, we need to source it to use it
      command: |
        set +e         
        touch $BASH_ENV    
        curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.5/install.sh | bash
        echo 'export NVM_DIR="$HOME/.nvm"' >> $BASH_ENV
        echo '[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"' >> $BASH_ENV
        echo nvm install <<parameters.node_version>> >> $BASH_ENV
        echo nvm alias default <<parameters.node_version>> >> $BASH_ENV
  - run:
      name: Verify node version
      command: node --version
